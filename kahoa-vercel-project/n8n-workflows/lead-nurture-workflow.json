{
  "name": "Kahoa Lead Nurture System",
  "nodes": [
    {
      "parameters": {
        "path": "lead-captured",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-trigger",
      "name": "New Lead Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "url": "https://api.clearbit.com/v2/combined/find",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBasicAuth",
        "options": {},
        "queryParametersUi": {
          "parameter": [
            {
              "name": "email",
              "value": "={{$json[\"lead\"][\"email\"]}}"
            }
          ]
        }
      },
      "id": "clearbit-enrichment",
      "name": "Clearbit Enrichment",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 3,
      "position": [450, 300]
    },
    {
      "parameters": {
        "model": "gpt-4",
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "You are an expert at qualifying B2B leads for AI training services. Score this lead from 0-100 based on company size, role seniority, and technology indicators."
            },
            {
              "role": "user", 
              "content": "Lead data: {{JSON.stringify($json)}}"
            }
          ]
        }
      },
      "id": "ai-lead-scoring",
      "name": "AI Lead Scoring",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1,
      "position": [650, 300]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{$json[\"score\"]}}",
              "operation": "largerEqual",
              "value2": 70
            }
          ]
        }
      },
      "id": "score-router",
      "name": "Score Router",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 1,
      "position": [850, 300]
    },
    {
      "parameters": {
        "channel": "#sales-alerts",
        "text": "ðŸ”¥ High-value lead captured!\n\nName: {{$node[\"webhook-trigger\"].json[\"lead\"][\"firstName\"]}} {{$node[\"webhook-trigger\"].json[\"lead\"][\"lastName\"]}}\nCompany: {{$node[\"webhook-trigger\"].json[\"lead\"][\"company\"]}}\nRole: {{$node[\"webhook-trigger\"].json[\"lead\"][\"role\"]}}\nScore: {{$json[\"score\"]}}/100\n\nLinkedIn: {{$node[\"webhook-trigger\"].json[\"lead\"][\"linkedInUrl\"]}}\n\nTake action: https://kahoa.ai/admin/leads/{{$node[\"webhook-trigger\"].json[\"lead\"][\"id\"]}}"
      },
      "id": "slack-notification",
      "name": "Slack Alert",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2,
      "position": [1050, 200]
    },
    {
      "parameters": {
        "operation": "create",
        "base": "appXXXXXXXXXXXXXX",
        "table": "Leads",
        "columns": {
          "values": {
            "Email": "={{$node[\"webhook-trigger\"].json[\"lead\"][\"email\"]}}",
            "Name": "={{$node[\"webhook-trigger\"].json[\"lead\"][\"firstName\"]}} {{$node[\"webhook-trigger\"].json[\"lead\"][\"lastName\"]}}",
            "Company": "={{$node[\"webhook-trigger\"].json[\"lead\"][\"company\"]}}",
            "Score": "={{$json[\"score\"]}}",
            "Status": "Qualified",
            "Source": "={{$node[\"webhook-trigger\"].json[\"lead\"][\"source\"]}}"
          }
        }
      },
      "id": "airtable-crm",
      "name": "Add to CRM",
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2,
      "position": [1050, 350]
    },
    {
      "parameters": {
        "fromEmail": "conor@kahoa.ai",
        "toEmail": "={{$node[\"webhook-trigger\"].json[\"lead\"][\"email\"]}}",
        "subject": "{{$node[\"webhook-trigger\"].json[\"lead\"][\"firstName\"]}}, your engineering team is leaving money on the table",
        "html": "<p>Hi {{$node[\"webhook-trigger\"].json[\"lead\"][\"firstName\"]}},</p>\n\n<p>I noticed you're exploring how to leverage AI for your engineering team at {{$node[\"webhook-trigger\"].json[\"lead\"][\"company\"]}}.</p>\n\n<p>After working with 50+ engineering teams, I've found that most developers only use 10% of AI's potential. The difference between teams that see minimal improvement and those that achieve 73% productivity gains? <strong>Structured training.</strong></p>\n\n<p>I'd love to share how companies like yours are transforming their developers into Intelligent Engineers.</p>\n\n<p>Are you free for a quick 30-minute call this week? Here's my calendar: <a href='https://calendly.com/conor-kahoa/discovery'>calendly.com/conor-kahoa</a></p>\n\n<p>Best,<br>Conor Larsson<br>CEO, Kahoa</p>"
      },
      "id": "high-value-email",
      "name": "High Value Email",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2,
      "position": [1250, 200]
    },
    {
      "parameters": {
        "operation": "create",
        "list": "nurture_sequence",
        "email": "={{$node[\"webhook-trigger\"].json[\"lead\"][\"email\"]}}",
        "additionalFields": {
          "firstName": "={{$node[\"webhook-trigger\"].json[\"lead\"][\"firstName\"]}}",
          "customFields": {
            "property": [
              {
                "key": "company",
                "value": "={{$node[\"webhook-trigger\"].json[\"lead\"][\"company\"]}}"
              },
              {
                "key": "score",
                "value": "={{$json[\"score\"]}}"
              }
            ]
          }
        }
      },
      "id": "add-to-nurture",
      "name": "Add to Nurture Sequence",
      "type": "n8n-nodes-base.mailchimp",
      "typeVersion": 2,
      "position": [1050, 500]
    }
  ],
  "connections": {
    "webhook-trigger": {
      "main": [
        [
          {
            "node": "clearbit-enrichment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "clearbit-enrichment": {
      "main": [
        [
          {
            "node": "ai-lead-scoring",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ai-lead-scoring": {
      "main": [
        [
          {
            "node": "score-router",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "score-router": {
      "main": [
        [
          {
            "node": "slack-notification",
            "type": "main",
            "index": 0
          },
          {
            "node": "airtable-crm",
            "type": "main",
            "index": 0
          },
          {
            "node": "high-value-email",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "add-to-nurture",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}